{
	"name": "Delta Load",
	"properties": {
		"activities": [
			{
				"name": "DiagnosisCodesStageLoad",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": {
							"value": "\nDECLARE @LastUpdatedDate DATETIME\nSELECT @LastUpdatedDate  = LastUpdatedDate FROM [Load].[Log]  WHERE FileType = 'DiagnosisCodes' \n\nSELECT \n\tICD.icd9_code_id\t\tAS IcdCodeId\n,\tICD.icd9_code\t\t\tAS IcdCode\n,\tICD.description\t\t\tAS IcdDescription\n\nFROM icd9_codes ICD\nWHERE\n\tICD.is_invalid = 0 AND\n\tICD.Type IN ('ICD10','ICD9') AND\n\tCAST(CONVERT(VARCHAR(10),ModifiedDate,120) AS DATETIME) >= CAST(CONVERT(VARCHAR(10),@LastUpdatedDate,120) AS DATETIME)",
							"type": "Expression"
						},
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "SqlPoolSink",
						"preCopyScript": {
							"value": "TRUNCATE TABLE load.DiagnosisCodes",
							"type": "Expression"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "IcdCodeId",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "IcdCodeId",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "IcdCode",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "IcdCode",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "IcdDescription",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "IcdDescription",
									"type": "String",
									"physicalType": "varchar"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DiagnosiscodeStageLoad",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DiagnosiscodeStageLoadpool",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "ClaimDetailsStageLoad",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": {
							"value": "DECLARE @LastUpdatedDate DATETIME\nSELECT @LastUpdatedDate  = LastUpdatedDate FROM [Load].[Log]  WHERE FileType = 'ClaimDetails' \n\nSELECT\n\t\n\tCFD.claim_form_detail_code\t\t\tAS 'ClaimFIRNo'\n,\tCFD.injury_Name\t\t\t\t\t\tAS 'Injury'\n,\tCFD.isCashless\t\t\t\t\t\tAS 'ClaimType'\n,\tCFD.Claim_type_Code\t\t\t\t\tAS 'ClaimCategory'\n,\tCFD.billed\t\t\t\t\t\t\tAS 'AmountBilled'\n,\tCFD.net\t\t\t\t\t\t\t\tAS 'AmountNet'\n,\tCFD.Amount_paid\t\t\t\t\t\tAS 'AmountPaid'\n,\tCFD.Dr_name\t\t\t\t\t\t\tAS 'DoctorName'\n,\tCFD.Dr_City\t\t\t\t\t\t\tAS 'DoctorCity'\n,\tCFD.claim_form_detail_id\t\t\tAS 'ClaimFormDetailId'\n,\tCFD.claim_detail_id\t\t\t\t\tAS 'IntimationId'\n,\tCFD.hosp_id\t\t\t\t\t\t\tAS 'HospitalId'\n,\tCFD.claim_status_id\t\t\t\t\tAS 'ClaimStatusId'\n,\tCFD.place_of_service_id\t\t\t\tAs 'PlaceofServiceId' \n,\tCFD.date_service\t\t\t\t\tAS 'DateofService'\n,\tCFD.date_paid\t\t\t\t\t\tAS 'DatePaid'\n,\tCFD.date_received\t\t\t\t\tAS 'DateReceived'\n,\tCFD.date_of_Admit\t\t\t\t\tAS 'DateofAdmit'\n,\tCFD.injury_sustained_date\t\t\tAS 'DateofInjury' \n,\tCFD.document_dated\t\t\t\t\tAS 'DateofDocumentation'\n,\tCFD.date_of_Discharge\t\t\t\tAS 'DateofDischarge'\n,\tCFD.date_modified\t\t\t\t\tAS 'DateModified'\n,\tCFD.workflow_current_sequence_id\tAS 'WorkflowSequenceId'\n,\tCFD.member_detail_id\t\t\t\tAS 'MemberDetailId'\n,\tCFD.Class_of_Accommodation\t\t\tAS 'ClassofAccommodation'\n,\tCFD.Type_of_Hospitalization\t\t\tAS 'HospitalizationType'\n,\tE.name\t\t\t\t\t\t\t\tAS 'Corporate'\n,\tCFD.claim_form_detail_id\t\t\tAS 'ClaimId'\n\nFROM claim_form_details CFD\nINNER JOIN Member_details_tmp MDT ON MDT.member_detail_id = CFD.member_detail_id\nLEFT OUTER JOIN employers E ON E.employer_id = MDT.employer_id\nWHERE \n\tISNULL(CFD.parent_claim_form_id,0) <> 0 AND\n\tCAST(CONVERT(VARCHAR(10),cfd.ModifiedDate,120) AS DATETIME) >= CAST(CONVERT(VARCHAR(10),@LastUpdatedDate,120) AS DATETIME)",
							"type": "Expression"
						},
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "SqlPoolSink",
						"preCopyScript": {
							"value": "truncate table load.ClaimDetails",
							"type": "Expression"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "ClaimFIRNo",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "ClaimFIRNo",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Injury",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "Injury",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "ClaimType",
									"type": "Boolean",
									"physicalType": "bit"
								},
								"sink": {
									"name": "ClaimType",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "ClaimCategory",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "ClaimCategory",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "AmountBilled",
									"type": "Decimal",
									"physicalType": "money",
									"scale": 4,
									"precision": 19
								},
								"sink": {
									"name": "AmountBilled",
									"type": "Decimal",
									"physicalType": "money",
									"scale": 4,
									"precision": 19
								}
							},
							{
								"source": {
									"name": "AmountNet",
									"type": "Decimal",
									"physicalType": "money",
									"scale": 4,
									"precision": 19
								},
								"sink": {
									"name": "AmountNet",
									"type": "Decimal",
									"physicalType": "money",
									"scale": 4,
									"precision": 19
								}
							},
							{
								"source": {
									"name": "AmountPaid",
									"type": "Decimal",
									"physicalType": "money",
									"scale": 4,
									"precision": 19
								},
								"sink": {
									"name": "AmountPaid",
									"type": "Decimal",
									"physicalType": "money",
									"scale": 4,
									"precision": 19
								}
							},
							{
								"source": {
									"name": "DoctorName",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "DoctorName",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "DoctorCity",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "DoctorCity",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "ClaimFormDetailId",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "ClaimFormDetailId",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "IntimationId",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "IntimationId",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "HospitalId",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "HospitalId",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "ClaimStatusId",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "ClaimStatusId",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "PlaceofServiceId",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "PlaceofServiceId",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "DateofService",
									"type": "DateTime",
									"physicalType": "datetime"
								},
								"sink": {
									"name": "DateofService",
									"type": "DateTime",
									"physicalType": "datetime"
								}
							},
							{
								"source": {
									"name": "DatePaid",
									"type": "DateTime",
									"physicalType": "datetime"
								},
								"sink": {
									"name": "DatePaid",
									"type": "DateTime",
									"physicalType": "datetime"
								}
							},
							{
								"source": {
									"name": "DateReceived",
									"type": "DateTime",
									"physicalType": "datetime"
								},
								"sink": {
									"name": "DateReceived",
									"type": "DateTime",
									"physicalType": "datetime"
								}
							},
							{
								"source": {
									"name": "DateofAdmit",
									"type": "DateTime",
									"physicalType": "datetime"
								},
								"sink": {
									"name": "DateofAdmit",
									"type": "DateTime",
									"physicalType": "datetime"
								}
							},
							{
								"source": {
									"name": "DateofInjury",
									"type": "DateTime",
									"physicalType": "datetime"
								},
								"sink": {
									"name": "DateofInjury",
									"type": "DateTime",
									"physicalType": "datetime"
								}
							},
							{
								"source": {
									"name": "DateofDocumentation",
									"type": "DateTime",
									"physicalType": "datetime"
								},
								"sink": {
									"name": "DateofDocumentation",
									"type": "DateTime",
									"physicalType": "datetime"
								}
							},
							{
								"source": {
									"name": "DateofDischarge",
									"type": "DateTime",
									"physicalType": "datetime"
								},
								"sink": {
									"name": "DateofDischarge",
									"type": "DateTime",
									"physicalType": "datetime"
								}
							},
							{
								"source": {
									"name": "DateModified",
									"type": "DateTime",
									"physicalType": "datetime"
								},
								"sink": {
									"name": "DateModified",
									"type": "DateTime",
									"physicalType": "datetime"
								}
							},
							{
								"source": {
									"name": "WorkflowSequenceId",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "WorkflowSequenceId",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "MemberDetailId",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "MemberDetailId",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "ClassofAccommodation",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "ClassofAccommodation",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "HospitalizationType",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "HospitalizationType",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Corporate",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "Corporate",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "ClaimId",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "ClaimId",
									"type": "Int32",
									"physicalType": "int"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "ClimDetailsStage",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "ClaimDetailsPoolStage",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "LnkClaimDiagnosisCodes",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": {
							"value": "\nDECLARE @LastUpdatedDate DATETIME\nSELECT @LastUpdatedDate  = LastUpdatedDate FROM [Load].[Log]  WHERE FileType = 'ClaimDiagnosisCodes' \n\n\nSELECT\n\tL.lcic_id\t\t\t\t\tAS 'ClaimDiagnosisId'\n,\tL.claim_form_detail_id\t\tAS 'ClaimFormDetailId'\n,\tL.icd9_code_id\t\t\t\tAS 'IcdCodeId'\n\nFROM claim_form_details CFD\nINNER JOIN lnk_claim_form_icd9_code L ON L.claim_form_detail_id = CFD.claim_form_detail_id\nWHERE \n\tISNULL(CFD.parent_claim_form_id,0) <> 0  \nAND\nCAST(CONVERT(VARCHAR(10),cfd.ModifiedDate,120) AS DATETIME) >= CAST(CONVERT(VARCHAR(10),@LastUpdatedDate,120) AS DATETIME)",
							"type": "Expression"
						},
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "SqlPoolSink",
						"preCopyScript": {
							"value": "TRUNCATE TABLE Load.LnkClaimDiagnosisCodes",
							"type": "Expression"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "ClaimDiagnosisId",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "ClaimDiagnosisId",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "ClaimFormDetailId",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "ClaimFormDetailId",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "IcdCodeId",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "IcdCodeId",
									"type": "Int32",
									"physicalType": "int"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "ClaimdiagnosiscodesStage",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "ClaimDiagnosicodesPoolTable",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "LnkClaimProcedureDetails",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": {
							"value": "DECLARE @LastUpdatedDate DATETIME\nSELECT @LastUpdatedDate  = LastUpdatedDate FROM [Load].[Log]  WHERE FileType = 'ClaimProcedureDetails' \n\n\nSELECT\n\t\tL.lccc_id\t\t\t\t\t\tAS 'ClaimProcedureId' \n,\t\tL.claim_form_detail_id\t\t\tAS 'ClaimFormDetailId'\n,\t\tL.cpt_code_id\t\t\t\t\tAS 'CptCodeId'\n,\t\tL.billed\t\t\t\t\t\tAS 'Billed'\n,\t\tL.net\t\t\t\t\t\t\tAS 'Net'\n,\t\tL.number_of_services\t\t\tAS 'NoofServices'\n,\t\tL.place_of_service_id\t\t\tAS 'PlaceofServiceId'\n,\t\tL.Amount\t\t\t\t\t\tAS 'Amount'\t\n,\t\tL.parent_service_procedure_id\tAS 'ParentServiceProcedureId'\n,\t\tL.GrossAmount\t\t\t\t\tAS 'GrossAmount'\n,\t\tL.Service_Start_Date\t\t\tAS 'ServiceStartDate'\n,\t\tL.Service_End_Date\t\t\t\tAS 'ServiceEndDate'\n,\t\tL.Billed_Gross\t\t\t\t\tAS 'BilledGross'\n,\t\tL.Service_Net\t\t\t\t\tAS 'ServiceNet'\n\nFROM claim_form_details CFD\nINNER JOIN lnk_claim_form_cpt_code L ON L.claim_form_detail_id = CFD.claim_form_detail_id\nWHERE \n\tISNULL(CFD.parent_claim_form_id,0) <> 0  \nAND\nCAST(CONVERT(VARCHAR(10),cfd.ModifiedDate,120) AS DATETIME) >= CAST(CONVERT(VARCHAR(10),@LastUpdatedDate,120) AS DATETIME)",
							"type": "Expression"
						},
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "SqlPoolSink",
						"preCopyScript": {
							"value": "TRUNCATE TABLE Load.ClaimProcedureDetails",
							"type": "Expression"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "ClaimProcedureId",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 0,
									"precision": 18
								},
								"sink": {
									"name": "ClaimProcedureId",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "ClaimFormDetailId",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 0,
									"precision": 18
								},
								"sink": {
									"name": "ClaimFormDetailId",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "CptCodeId",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 0,
									"precision": 18
								},
								"sink": {
									"name": "CptCodeId",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "Billed",
									"type": "Decimal",
									"physicalType": "money",
									"scale": 4,
									"precision": 19
								},
								"sink": {
									"name": "Billed",
									"type": "Decimal",
									"physicalType": "money",
									"scale": 4,
									"precision": 19
								}
							},
							{
								"source": {
									"name": "Net",
									"type": "Decimal",
									"physicalType": "money",
									"scale": 4,
									"precision": 19
								},
								"sink": {
									"name": "Net",
									"type": "Decimal",
									"physicalType": "money",
									"scale": 4,
									"precision": 19
								}
							},
							{
								"source": {
									"name": "NoofServices",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 2,
									"precision": 19
								},
								"sink": {
									"name": "NoofServices",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 2,
									"precision": 19
								}
							},
							{
								"source": {
									"name": "PlaceofServiceId",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "PlaceofServiceId",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "Amount",
									"type": "Decimal",
									"physicalType": "money",
									"scale": 4,
									"precision": 19
								},
								"sink": {
									"name": "Amount",
									"type": "Decimal",
									"physicalType": "money",
									"scale": 4,
									"precision": 19
								}
							},
							{
								"source": {
									"name": "ParentServiceProcedureId",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "ParentServiceProcedureId",
									"type": "Decimal",
									"physicalType": "money",
									"scale": 4,
									"precision": 19
								}
							},
							{
								"source": {
									"name": "GrossAmount",
									"type": "Decimal",
									"physicalType": "money",
									"scale": 4,
									"precision": 19
								},
								"sink": {
									"name": "GrossAmount",
									"type": "Decimal",
									"physicalType": "money",
									"scale": 4,
									"precision": 19
								}
							},
							{
								"source": {
									"name": "ServiceStartDate",
									"type": "DateTime",
									"physicalType": "datetime"
								},
								"sink": {
									"name": "ServiceStartDate",
									"type": "DateTime",
									"physicalType": "datetime"
								}
							},
							{
								"source": {
									"name": "ServiceEndDate",
									"type": "DateTime",
									"physicalType": "datetime"
								},
								"sink": {
									"name": "ServiceEndDate",
									"type": "DateTime",
									"physicalType": "datetime"
								}
							},
							{
								"source": {
									"name": "BilledGross",
									"type": "Decimal",
									"physicalType": "money",
									"scale": 4,
									"precision": 19
								},
								"sink": {
									"name": "BilledGross",
									"type": "Decimal",
									"physicalType": "money",
									"scale": 4,
									"precision": 19
								}
							},
							{
								"source": {
									"name": "ServiceNet",
									"type": "Decimal",
									"physicalType": "money",
									"scale": 4,
									"precision": 19
								},
								"sink": {
									"name": "ServiceNet",
									"type": "Decimal",
									"physicalType": "money",
									"scale": 4,
									"precision": 19
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "LnkClaimProcedureDetails",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "LnkClaimProcedureDetailsPool",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "DimEmployersStageLoad",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": {
							"value": "DECLARE @LastUpdatedDate DATETIME\nSELECT @LastUpdatedDate  = LastUpdatedDate FROM [Load].[Log]  WHERE FileType = 'Employers' \n\n\nSELECT \n\tEMP.employer_id\t\t\tAS 'EmployerId'\n,\tEMP.employer_code\t\tAS 'EmployerCode'\n,\tEMP.name\t\t\t\tAS 'EmployerName'\n,\tEmp.employer_detail_id\tAS 'EmployerDetailid'\n,\tEMP.city\t\t\t\tAS 'EmpCity'\n,\tEMP.state\t\t\t\tAS 'EmpState'\n,\tEMP.zip_code\t\t\tAS 'EmpZipcode'\n,\tEMP.email\t\t\t\tAS 'EmpEmail'\n,\tEMP.PremiumNet\t\t\tAS 'PremiumNet'\n,\tEMP.PremiumGross\t\tAS 'PremiumGross'\n,\tEMP.Premiumtax\t\t\tAS 'Premiumtax'\n,\tEMP.NoOfLives\t\t\tAS 'NoOfLives'\n,\tEMP.policyfrom\t\t\tAS 'policyFromDate'\n,\tEMP.policyto\t\t\tAS 'policyToDate'\n,\tEMP.agent\t\t\t\tAS 'Agent'\n,\tEMP.policy_number\t\tAS 'PolicyNo'\n,\tEMP.Contract_Id\t\t\tAS 'PolicyId'\n,\tEMP.bankname\t\t\tAS 'BankName'\t\n,\tEMP.bankAccNo\t\t\tAS 'BankAccNo'\n,\tEMP.bankcity\t\t\tAS 'BankCity'\n,\tEMP.bankstate\t\t\tAS 'BankState'\n\nFROM employers EMP\nWHERE\n\tEMP.isDisabled = 0 \nAND \nCAST(CONVERT(VARCHAR(10),ModifiedDate,120) AS DATETIME) >= CAST(CONVERT(VARCHAR(10),@LastUpdatedDate,120) AS DATETIME)",
							"type": "Expression"
						},
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "SqlPoolSink",
						"preCopyScript": {
							"value": "TRUNCATE TABLE [Load].[Employers]",
							"type": "Expression"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "EmployerId",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "EmployerId",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "EmployerCode",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "EmployerCode",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "EmployerName",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "EmployerName",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "EmployerDetailid",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "EmployerDetailid",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "EmpCity",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "EmpCity",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "EmpState",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "EmpState",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "EmpZipcode",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "EmpZipcode",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "EmpEmail",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "EmpEmail",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "PremiumNet",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 0,
									"precision": 18
								},
								"sink": {
									"name": "PremiumNet",
									"type": "Decimal",
									"physicalType": "money",
									"scale": 4,
									"precision": 19
								}
							},
							{
								"source": {
									"name": "PremiumGross",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 0,
									"precision": 18
								},
								"sink": {
									"name": "PremiumGross",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 0,
									"precision": 18
								}
							},
							{
								"source": {
									"name": "Premiumtax",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 0,
									"precision": 18
								},
								"sink": {
									"name": "Premiumtax",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 0,
									"precision": 18
								}
							},
							{
								"source": {
									"name": "NoOfLives",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 0,
									"precision": 18
								},
								"sink": {
									"name": "NoOfLives",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 0,
									"precision": 18
								}
							},
							{
								"source": {
									"name": "policyFromDate",
									"type": "DateTime",
									"physicalType": "datetime"
								},
								"sink": {
									"name": "policyFromDate",
									"type": "DateTime",
									"physicalType": "datetime"
								}
							},
							{
								"source": {
									"name": "policyToDate",
									"type": "DateTime",
									"physicalType": "datetime"
								},
								"sink": {
									"name": "policyToDate",
									"type": "DateTime",
									"physicalType": "datetime"
								}
							},
							{
								"source": {
									"name": "Agent",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "Agent",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "PolicyNo",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "PolicyNo",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "PolicyId",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "PolicyId",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "BankName",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "BankName",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "BankAccNo",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "BankAccNo",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "BankCity",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "BankCity",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "BankState",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "BankState",
									"type": "String",
									"physicalType": "varchar"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DimEmployers",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "EmployersPoolStage",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "DimHospitalDetails",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": {
							"value": "\nDECLARE @LastUpdatedDate DATETIME\nSELECT @LastUpdatedDate  = LastUpdatedDate FROM [Load].[Log]  WHERE FileType = 'HospitalDetails' \n\nSELECT \n\n\tP.provider_id\t\t\tAS 'HospitalId'\n,\tP.provider_code\t\t\tAS 'HospitalCode'\n,\tP.last_name\t\t\t\tAS 'HospitalName' \n,\tP.is_specialist\t\t\tAS 'IsSpecialist'\n,\tP.is_referring_provider\tAS 'IsReferringProvider'\n,\tP.provider_type_id\t\tAS 'ProviderTypeId'\n,\tL.city\t\t\t\t\tAS 'ProviderCity'\n,\tS.state_name\t\t\tAS 'ProviderState'\n,\tC.country_name\t\t\tAS 'ProviderCountry'\n\nFROM provider_info P\nINNER JOIN lnk_provider_address L ON L.provider_id =P.provider_id\nLEFT OUTER JOIN states S ON S.state_id =L.state\nINNER JOIN Countries C ON C.country_id =S.country_id\nAND \nCAST(CONVERT(VARCHAR(10),p.ModifiedDate,120) AS DATETIME) >= CAST(CONVERT(VARCHAR(10),@LastUpdatedDate,120) AS DATETIME)",
							"type": "Expression"
						},
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "SqlPoolSink",
						"preCopyScript": {
							"value": "TRUNCATE TABLE [Load].[HospitalDetails]",
							"type": "Expression"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "HospitalId",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "HospitalId",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "HospitalCode",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "HospitalCode",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "HospitalName",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "HospitalName",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "IsSpecialist",
									"type": "Boolean",
									"physicalType": "bit"
								},
								"sink": {
									"name": "IsSpecialist",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "IsReferringProvider",
									"type": "Boolean",
									"physicalType": "bit"
								},
								"sink": {
									"name": "IsReferringProvider",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "ProviderTypeId",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "ProviderTypeId",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "ProviderCity",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "ProviderCity",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "ProviderState",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "ProviderState",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "ProviderCountry",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "ProviderCountry",
									"type": "String",
									"physicalType": "varchar"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DimHospitalDetails",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "HospitalDetailsPoolLoad",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "DimMemberDetails",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": {
							"value": "DECLARE @LastUpdatedDate DATETIME\nSELECT @LastUpdatedDate  = LastUpdatedDate FROM [Load].[Log]  WHERE FileType = 'MemberDetails' \nSELECT \n\tmember_detail_id\n,\tmember_id\n,\tstart_effective_date\n,\tend_effective_date\n,\tlocation_id\n,\temployer_id\n,\tproduct_type_id\n,\tcity\n,\tstate\n,\tzip_code\n,\temail\n,\tMobileNo\n,\tPanNo\n,\tDrivingNo\n,\tVoterID\n,\tRation_Card\n,\tmember_code_tmp\n,\tis_missing\n,\tAccountNo\n,\tBank_Name\n,\tBank_Branch\n,\tBranch_Code\n,\tDesignation\n,\tDepartment\n,\tPolicytype\n,\tProductID\n,\tpolicyNo\n,\tSumInsured\n,\tCummulative\n,\tPremium\n,\tRenewal\n,\tSubscriber_Detail_id\n,\tRelationshipID\n,\tPlan_id\n,\tSumInsuredper\n,\tCardPer\n,\tEmployee_No\n,\tBloodgroup\n,\tSalaryGrade\n,\tCoInsurance\n,\tagentcode\n,\tmember_insurer_id\n,\tcountry\n,\tdistrict\n,\tworkflow_current_sequence_id\n,\tpolicy_from_date\n,\tpolicy_to_date\n,\tContract_Id\n,\tDateCreated\n,\tcovered_from_date\n,\tEnd_Ren_Date\n,\tendorsement_no\n,\tEndorsement_Date\n,\tParent_Member_detail_id\n--,\tIsRecommenced\n--,\tSeqNo\n,\tMemberCreatedDate\n,\tModifiedDate\n--,\tEndorsement_Comment\n--,\tRenewalNo\n\nFROM  member_details_tmp MDT \n WHERE CAST(CONVERT(VARCHAR(10),MDT.ModifiedDate,120) AS DATETIME) >= CAST(CONVERT(VARCHAR(10),@LastUpdatedDate,120) AS DATETIME)\n",
							"type": "Expression"
						},
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "SqlPoolSink",
						"preCopyScript": {
							"value": "TRUNCATE TABLE Load.MemberDetails",
							"type": "Expression"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "member_detail_id",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "member_detail_id",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "member_id",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "member_id",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "start_effective_date",
									"type": "DateTime",
									"physicalType": "datetime"
								},
								"sink": {
									"name": "start_effective_date",
									"type": "DateTime",
									"physicalType": "datetime"
								}
							},
							{
								"source": {
									"name": "end_effective_date",
									"type": "DateTime",
									"physicalType": "datetime"
								},
								"sink": {
									"name": "end_effective_date",
									"type": "DateTime",
									"physicalType": "datetime"
								}
							},
							{
								"source": {
									"name": "location_id",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "location_id",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "employer_id",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "employer_id",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "product_type_id",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "product_type_id",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "city",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "city",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "state",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "state",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "zip_code",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "zip_code",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "email",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "email",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "MobileNo",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "MobileNo",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "PanNo",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "PanNo",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "DrivingNo",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "DrivingNo",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "VoterID",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "VoterID",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Ration_Card",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "Ration_Card",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "member_code_tmp",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "member_code_tmp",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "is_missing",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "is_missing",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "AccountNo",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "AccountNo",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Bank_Name",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "Bank_Name",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Bank_Branch",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "Bank_Branch",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Branch_Code",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "Branch_Code",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Designation",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "Designation",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Department",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "Department",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Policytype",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "Policytype",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "ProductID",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "ProductID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "policyNo",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "policyNo",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "SumInsured",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 2,
									"precision": 18
								},
								"sink": {
									"name": "SumInsured",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 2,
									"precision": 18
								}
							},
							{
								"source": {
									"name": "Cummulative",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 2,
									"precision": 18
								},
								"sink": {
									"name": "Cummulative",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 2,
									"precision": 18
								}
							},
							{
								"source": {
									"name": "Premium",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 2,
									"precision": 18
								},
								"sink": {
									"name": "Premium",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 2,
									"precision": 18
								}
							},
							{
								"source": {
									"name": "Renewal",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "Renewal",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Subscriber_Detail_id",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "Subscriber_Detail_id",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "RelationshipID",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "RelationshipID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "Plan_id",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "Plan_id",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "SumInsuredper",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "SumInsuredper",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "CardPer",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "CardPer",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Employee_No",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "Employee_No",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Bloodgroup",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "Bloodgroup",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "SalaryGrade",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "SalaryGrade",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "CoInsurance",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "CoInsurance",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "agentcode",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "agentcode",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "member_insurer_id",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "member_insurer_id",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "country",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "country",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "district",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "district",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "workflow_current_sequence_id",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "workflow_current_sequence_id",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "policy_from_date",
									"type": "DateTime",
									"physicalType": "datetime"
								},
								"sink": {
									"name": "policy_from_date",
									"type": "DateTime",
									"physicalType": "datetime"
								}
							},
							{
								"source": {
									"name": "policy_to_date",
									"type": "DateTime",
									"physicalType": "datetime"
								},
								"sink": {
									"name": "policy_to_date",
									"type": "DateTime",
									"physicalType": "datetime"
								}
							},
							{
								"source": {
									"name": "Contract_Id",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "Contract_Id",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "DateCreated",
									"type": "DateTime",
									"physicalType": "smalldatetime"
								},
								"sink": {
									"name": "DateCreated",
									"type": "DateTime",
									"physicalType": "datetime"
								}
							},
							{
								"source": {
									"name": "covered_from_date",
									"type": "DateTime",
									"physicalType": "datetime"
								},
								"sink": {
									"name": "covered_from_date",
									"type": "DateTime",
									"physicalType": "datetime"
								}
							},
							{
								"source": {
									"name": "End_Ren_Date",
									"type": "DateTime",
									"physicalType": "datetime"
								},
								"sink": {
									"name": "End_Ren_Date",
									"type": "DateTime",
									"physicalType": "datetime"
								}
							},
							{
								"source": {
									"name": "endorsement_no",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "endorsement_no",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Endorsement_Date",
									"type": "DateTime",
									"physicalType": "datetime"
								},
								"sink": {
									"name": "Endorsement_Date",
									"type": "DateTime",
									"physicalType": "datetime"
								}
							},
							{
								"source": {
									"name": "Parent_Member_detail_id",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "Parent_Member_detail_id",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "MemberCreatedDate",
									"type": "DateTime",
									"physicalType": "datetime"
								},
								"sink": {
									"name": "MemberCreatedDate",
									"type": "DateTime",
									"physicalType": "datetime"
								}
							},
							{
								"source": {
									"name": "ModifiedDate",
									"type": "DateTime",
									"physicalType": "datetime"
								},
								"sink": {
									"name": "ModifiedDate",
									"type": "DateTime",
									"physicalType": "datetime"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DimMemberDetails",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DimMemberDetailsPool",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "DimMembers",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": {
							"value": "\nDECLARE @LastUpdatedDate DATETIME\nSELECT @LastUpdatedDate  = LastUpdatedDate FROM [Load].[Log]  WHERE FileType = 'Members' \n\nSELECT DISTINCT \n\n\tM.member_id\n,\tM.member_code\n,\tM.first_name\n,\tM.last_name\n,\tM.date_birth\n,\tM.sex\n,\tM.subscriber_id\n,\tM.user_id\n,\tM.FullMemberName\n,\tM.SequenceNo\n--,\tM.Date_Created\nFROM  member_details_tmp MDT \nINNER JOIN members_tmp M ON MDT.member_id = M.member_id\n \n WHERE CAST(CONVERT(VARCHAR(10),MDT.ModifiedDate,120) AS DATETIME) >= CAST(CONVERT(VARCHAR(10),@LastUpdatedDate,120) AS DATETIME)\n",
							"type": "Expression"
						},
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "SqlPoolSink",
						"preCopyScript": {
							"value": "TRUNCATE TABLE Load.Members",
							"type": "Expression"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "member_id",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "member_id",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "member_code",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "member_code",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "first_name",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "first_name",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "last_name",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "last_name",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "date_birth",
									"type": "DateTime",
									"physicalType": "datetime"
								},
								"sink": {
									"name": "date_birth",
									"type": "DateTime",
									"physicalType": "datetime"
								}
							},
							{
								"source": {
									"name": "sex",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "sex",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "subscriber_id",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 0,
									"precision": 10
								},
								"sink": {
									"name": "subscriber_id",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 0,
									"precision": 10
								}
							},
							{
								"source": {
									"name": "user_id",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "user_id",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "FullMemberName",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "FullMemberName",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "SequenceNo",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "SequenceNo",
									"type": "String",
									"physicalType": "varchar"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DimMembers",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DimMembersPool",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "DimProcedureCategories",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": {
							"value": "\nDECLARE @LastUpdatedDate DATETIME\nSELECT @LastUpdatedDate  = LastUpdatedDate FROM [Load].[Log]  WHERE FileType = 'ProcedureCategories' \n\nSELECT \n\tP.procedure_category_id\t\tAS ProcedureCategoryId\n,\tP.procedure_category_code\tAS ProcedureCategoryCode\n,\tP.description\t\t\t\tAS ProcedureCategoryDesc\n\nFROM procedure_categories P \nWHERE CAST(CONVERT(VARCHAR(10),p.ModifiedDate,120) AS DATETIME) >= CAST(CONVERT(VARCHAR(10),@LastUpdatedDate,120) AS DATETIME)\n",
							"type": "Expression"
						},
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "SqlPoolSink",
						"preCopyScript": {
							"value": "TRUNCATE TABLE Load.ProcedureCategories",
							"type": "Expression"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "ProcedureCategoryId",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "ProcedureCategoryId",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "ProcedureCategoryCode",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "ProcedureCategoryCode",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "ProcedureCategoryDesc",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "ProcedureCategoryDesc",
									"type": "String",
									"physicalType": "varchar"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DimProcedureCategories",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DimProcedureCategoriesPool",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "DimProcedureCodes",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": {
							"value": "\nDECLARE @LastUpdatedDate DATETIME\nSELECT @LastUpdatedDate  = LastUpdatedDate FROM [Load].[Log]  WHERE FileType = 'ProcedureCodes' \n\nSELECT \n\tCPT.cpt_code_id\t\t\t\tAS CptCodeId\n,\tCPT.Cpt_Code\t\t\t\tAS CptCode\n,\tCPT.description\t\t\t\tAS CptDescription\n,\tCPT.procedure_category_id\tAS ProcedureCategoryId\n\nFROM cpt_codes CPT\nWHERE\n\tCPT.is_invalid = 0 AND\n\tCPT.Type = 'CPT' AND\n\tCAST(CONVERT(VARCHAR(10),CPT.ModifiedDate,120) AS DATETIME) >= CAST(CONVERT(VARCHAR(10),@LastUpdatedDate,120) AS DATETIME)",
							"type": "Expression"
						},
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "SqlPoolSink",
						"preCopyScript": {
							"value": "TRUNCATE TABLE [Load].[ProcedureCodes]",
							"type": "Expression"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DimProcedureCodes",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DimProcedureCodesPool",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "SQL pool stored procedure Diagnosis code",
				"type": "SqlPoolStoredProcedure",
				"dependsOn": [
					{
						"activity": "DiagnosisCodesStageLoad",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"sqlPool": {
					"referenceName": "SqlPoolTableSynapse",
					"type": "SqlPoolReference"
				},
				"typeProperties": {
					"storedProcedureName": "[dbo].[UpsertDiagnosisCodes]"
				}
			},
			{
				"name": "SQL pool stored procedure Claim Load",
				"type": "SqlPoolStoredProcedure",
				"dependsOn": [
					{
						"activity": "ClaimDetailsStageLoad",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"sqlPool": {
					"referenceName": "SqlPoolTableSynapse",
					"type": "SqlPoolReference"
				},
				"typeProperties": {
					"storedProcedureName": "[Load].[UpsertClaimDetails]"
				}
			},
			{
				"name": "SQL pool stored procedure Claim Diagnosi Codes",
				"type": "SqlPoolStoredProcedure",
				"dependsOn": [
					{
						"activity": "LnkClaimDiagnosisCodes",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"sqlPool": {
					"referenceName": "SqlPoolTableSynapse",
					"type": "SqlPoolReference"
				},
				"typeProperties": {
					"storedProcedureName": "[dbo].[UpsertLnkClaimDiagnosisCodes]"
				}
			},
			{
				"name": "SQL pool stored procedure claim Procedure code",
				"type": "SqlPoolStoredProcedure",
				"dependsOn": [
					{
						"activity": "LnkClaimProcedureDetails",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"sqlPool": {
					"referenceName": "SqlPoolTableSynapse",
					"type": "SqlPoolReference"
				},
				"typeProperties": {
					"storedProcedureName": "[dbo].[UpsertLnkClaimProcedureDetails]"
				}
			},
			{
				"name": "SQL pool stored procedure Employers",
				"type": "SqlPoolStoredProcedure",
				"dependsOn": [
					{
						"activity": "DimEmployersStageLoad",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"sqlPool": {
					"referenceName": "SqlPoolTableSynapse",
					"type": "SqlPoolReference"
				},
				"typeProperties": {
					"storedProcedureName": "[dbo].[UpsertDimEmployers]"
				}
			},
			{
				"name": "SQL pool stored procedure Hospital Details",
				"type": "SqlPoolStoredProcedure",
				"dependsOn": [
					{
						"activity": "DimHospitalDetails",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"sqlPool": {
					"referenceName": "SqlPoolTableSynapse",
					"type": "SqlPoolReference"
				},
				"typeProperties": {
					"storedProcedureName": "[dbo].[UpsertDimHospitalDetails]"
				}
			},
			{
				"name": "SQL pool stored procedure Members",
				"type": "SqlPoolStoredProcedure",
				"dependsOn": [
					{
						"activity": "DimMemberDetails",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"sqlPool": {
					"referenceName": "SqlPoolTableSynapse",
					"type": "SqlPoolReference"
				},
				"typeProperties": {
					"storedProcedureName": "[dbo].[UpsertDimMemberDetails]"
				}
			},
			{
				"name": "SQL pool stored procedure Member Load",
				"type": "SqlPoolStoredProcedure",
				"dependsOn": [
					{
						"activity": "DimMembers",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"sqlPool": {
					"referenceName": "SqlPoolTableSynapse",
					"type": "SqlPoolReference"
				},
				"typeProperties": {
					"storedProcedureName": "[dbo].[UpsertDimMembers]"
				}
			},
			{
				"name": "SQL pool stored procedure Procedure Category",
				"type": "SqlPoolStoredProcedure",
				"dependsOn": [
					{
						"activity": "DimProcedureCategories",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"sqlPool": {
					"referenceName": "SqlPoolTableSynapse",
					"type": "SqlPoolReference"
				},
				"typeProperties": {
					"storedProcedureName": "[dbo].[UpsertDimProcedureCategories]"
				}
			},
			{
				"name": "SQL pool stored procedure  Codes",
				"type": "SqlPoolStoredProcedure",
				"dependsOn": [
					{
						"activity": "DimProcedureCodes",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"sqlPool": {
					"referenceName": "SqlPoolTableSynapse",
					"type": "SqlPoolReference"
				},
				"typeProperties": {
					"storedProcedureName": "[dbo].[UpsertDimProcedureCodes]"
				}
			}
		],
		"annotations": [],
		"lastPublishTime": "2021-05-06T16:19:58Z"
	},
	"type": "Microsoft.Synapse/workspaces/pipelines"
}